<!-- templates/tasks/tasks_list.html -->
{% extends "base.html" %}
{% load django_bootstrap5 %}

{% block content %}
<h1 class="my-4">Задачи</h1>

<a href="{% url 'tasks:task_create' %}" class="btn btn-primary mb-3">Создать задачу</a> 

<form method="get" class="row g-3 mb-4">
  <div class="col-md-3">
    {% bootstrap_field filterset.form.status show_label=False %}
  </div>
  <div class="col-md-3">
    {% bootstrap_field filterset.form.executor show_label=False %}
  </div>
  <div class="col-md-3">
    {% bootstrap_field filterset.form.labels show_label=False %}
  </div>
  <div class="col-md-3">
    <div class="form-check mt-4">
      {% bootstrap_field filterset.form.self_tasks show_label=False %}
      <label class="form-check-label" for="{{ filterset.form.self_tasks.id_for_label }}">
        Только мои задачи
      </label>
    </div>
  </div>
  <div class="col-12">
    {% bootstrap_button "Применить" button_type="submit" button_class="btn-primary" %}
    <a href="{% url 'tasks:task_list' %}" class="btn btn-secondary">Сбросить</a>  <!-- Исправлено! -->
  </div>
</form>

{% for task in tasks %}
  <div class="card mb-2">
    <div class="card-body">
      <h5 class="card-title">{{ task.name }}</h5>
      <p class="card-text">
        <strong>Статус:</strong> {{ task.status }}<br>
        <strong>Автор:</strong> {{ task.author }}<br>
        <strong>Исполнитель:</strong> {{ task.executor|default:"Не назначен" }}
      </p>
      {% if task.labels.all %}
        <p class="card-text">
          <strong>Метки:</strong>
          {% for label in task.labels.all %}
            <span class="badge bg-secondary">{{ label }}</span>
          {% endfor %}
        </p>
      {% endif %}
    </div>
  </div>
{% empty %}
  <div class="alert alert-info" role="alert">
    Нет задач.
  </div>
{% endfor %}
{% endblock %}