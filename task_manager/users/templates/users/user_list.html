{% extends "base.html" %}
{% load django_bootstrap5 %}

{% block title %}Список пользователей{% endblock %}
{% block content %}
<div class="d-flex justify-content between align-items-center mb-4">
    <h1>Список пользователей</h1>
    {% if user.is_authenticated and user.is_staff %}
        <a href="{% url "register" %}" class="btn btn-success">
            <i class="bi bi-person-plus"></i>Создать пользователя
        </a>
    {% endif %}
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Email</th>
                <th>Имя</th>
                <th>Фамилия</th>
                <th>Staff</th>
                <th>Active</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for user_obj in users %}
            <tr>
                <td>{{ user_obj.id }}</td>
                <td>{{ user_obj.username }}</td>
                <td>{{ user_obj.email }}</td>
                <td>{{ user_obj.first_name }}</td>
                <td>{{ user_obj.last_name }}</td>
                <td>
                    {% if user_obj.is_staff %}
                        <span class="badge bg-success">Да</span>
                    {% else %}
                        <span class="badge bg-secondary">Нет</span>
                    {% endif %}
                </td>
                <td>
                    {% if user_obj.is_active %}
                        <span class="badge bg-success">Да</span>
                    {% else %}
                        <span class="badge bg-danger">Нет</span>
                    {% endif %}
                </td>
                <td>
                    <div class="btn-group btn-group-sm">
                        {% if user.is_authenticated and user.is_staff or user.id == user_obj.id %}
                            <a href="{% url 'users:update' user_obj.id %}" class="btn btn-outline-primary">
                                Редактировать
                            </a>
                        {% endif %}
                        {% if user.is_authenticated and user.is_staff and user.id != user_obj.id %}
                            <a href="{% url 'users:delete' user_obj.id %}" class="btn btn-outline-danger">
                                Удалить
                            </a>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8" class="text-center text-muted">Пользователи не найдены</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
